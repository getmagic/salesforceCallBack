<!DOCTYPE html>
<apex:page showHeader="false" standardStylesheets="false">
<html>
<head>
  <meta charset="utf-8">
  <title>URL.createObjectURL example</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsforce/1.3.1/jsforce.min.js"></script>
 
</head>
<body>
  <button onclick="jsforce.browser.login();">Login</button>
  <h1>GeeksforGeeks</h1>
  <input type="file">
  <img>
  <p class="p">The URL of this image is : </p>
</body>
 
  <script>
  
  
  console.log("about to initialize");
  
    jsforce.browser.init({
        clientId: '3MVG9riCAn8HHkYWyDUteqZ_T5xUUpjPWGSgHayKnlQyuZyE36IMDHNU_z5dzsO1BFgdVowazpUM05sa8E.oX', //client ID= consumer key of connected app
        redirectUri: 'https://getmagic.github.io/salesforceCallBack/authorization.html',
      // proxyUrl: 'https://your-jsforce-proxy-server.herokuapp.com/proxy/'
    });
  
  jsforce.browser.on('connect', function(conn) { 
    console.log("connection!");
    var fileName="Blob";
    var fileType = 'image/jpeg';
    var Element = document.querySelector('input');
    var img = document.querySelector('img');
    Element.addEventListener('change', function() {
      var url = URL.createObjectURL(Element.files[0]);
      img.src = url;
      console.log(url);
      var d=document.querySelector(".p");
      d.textContent+=url;
      //var fileToUpload= base64Encode(url);
      
      var reader = new FileReader();
      reader.readAsDataURL(url); 
      reader.onloadend = function() {
        var base64data = reader.result;                
        //console.log(base64data);
        console.log( base64data.substr(base64data.indexOf(',')+1) );
      }
      
      //var base64data = Buffer.from(url).toString('base64');
      conn.sobject('Attachment').create({ //Uploads this into the attachments section of the id of the desired project 
                ParentId: 'a008c00000aF20pAAC', //id of mentee project where u want to upload file???? //touching Fremont rn
                Name : fileName,
                Body: base64data,
                ContentType : fileType, 
              });
            //},
         //   function(err, uploadedAttachment) {
               // console.log(err,uploadedAttachment);
      // }); //end of conn.sobject('Attachment')
});

});
  
    
</script>
  

</html>
</apex:page>
